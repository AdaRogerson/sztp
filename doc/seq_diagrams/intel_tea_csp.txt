participant OEM
participant HOST
participant IPU
participant DHCP/NTP
participant DNS
participant TEA
participant CSP

group Initial Network discovery
       IPU->>IPU: Choose port/interface for onboarding
       IPU<<->>DHCP/NTP: Standard dhcp IP provisioning
       IPU<<-DHCP/NTP: Gets time from ntp server
end
    
group Initial Device Provisioning andIdentity Database

       IPU->>DNS: Reslove IP of TEA server
       IPU<->TEA: Start VPN tunnel to server (WG/IPsec)
       IPU->>TEA: Measurements 
       TEA-->>TEA: IPU measurements validated
       TEA->>IPU: CSP Server VPN URL
       IPU-->>IPU: Extract CSP Server URL
       IPU-->>IPU: Status changes to waiting
end
    
group IPU joins CSP
        IPU->>TEA: Establish VPN connection with TEA
        IPU->>TEA: Measurements
        TEA-->>TEA: Measurements validated
        IPU-->>IPU: Status changes to IMC booted
end  
group CSP provisions IPU
        CSP->>IPU: Sends ACC image
        IPU-->>IPU: IPU boots ACC
        IPU-->>IPU: Status changes to ACC booted
        CSP<->>IPU: Redfish established connection with IPU
end
