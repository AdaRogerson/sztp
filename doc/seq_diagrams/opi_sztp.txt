participant OEM
participant HOST
participant IPU
participant DHCP
participant SZTP-server

group preboot
	OEM->IPU:TLS cert
	OEM->IPU: SZTP pub key for ownership voucher
end

group Initial Network discovery
	IPU->>IPU: Choose port/interface for onboarding   
    IPU->>DHCP: DHCP request + OPTION_V4_SZTP_REDIRECT 
    IPU<<-DHCP: DHCP response + OPTION_V4_SZTP_REDIRECT + Redirect info
	IPU-->IPU: parse redirect info
end

group sztp trust establishment
	IPU<->SZTP-server: TSL/HTTP connection
    IPU->SZTP-server: Inintalize trust establishment
	SZTP-server-->SZTP-server: Asserts IPUs certs
    SZTP-server->IPU: 🔐 onboarding info (Boot img + scripts) encrypt with ownership voucher private key
    IPU-->IPU: 🔑 decrypt onboarding info with ownership voucher pub key

end
    
    


